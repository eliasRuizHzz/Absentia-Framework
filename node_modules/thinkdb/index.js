var MongoClient = require('mongodb').MongoClient;
// Use connect method to connect to the Server 

var MongoDB = {}
MongoDB.domain = "localhost";
MongoDB.port = "27017";
MongoDB.projectname = "es6mx";

MongoDB.tables1893514446 = {}

MongoDB.newtable = function(name,arr) {
	MongoDB.tables1893514446[name] = arr;
}

MongoDB.approval = function(name,arr) {
	if (MongoDB.tables1893514446[name].length == arr.length){
		var newobj = {};
		for (var i = 0; i < MongoDB.tables1893514446[name].length; i++) {
			newobj[MongoDB.tables1893514446[name][i]] = arr[i];
		};
		return newobj;
	}else{
		return false;
	}
}

MongoDB.insert = function(data,callback,collectionname){
	var url = 'mongodb://'+MongoDB.domain+':'+MongoDB.port+'/'+MongoDB.projectname;
	MongoClient.connect(url, function(err, db) {
	 	var collection = db.collection(collectionname);
	 	collection.insert(data,function(err, result) {
	 		db.close();
	 		callback(result);
	 	});
	});
}

/*
DB.insert({data:"Ready"},fucntion(result){
	
},"test");
*/

MongoDB.find = function(data,callback,collectionname){
	var url = 'mongodb://'+MongoDB.domain+':'+MongoDB.port+'/'+MongoDB.projectname;
	MongoClient.connect(url, function(err, db) {
	 	var collection = db.collection(collectionname);
	 	collection.find(data).toArray(function(err, documents) {
	 		db.close();
	 		callback(documents);
	 	});
	});
}

MongoDB.findOne = function(data,callback,collectionname){
	var url = 'mongodb://'+MongoDB.domain+':'+MongoDB.port+'/'+MongoDB.projectname;
	MongoClient.connect(url, function(err, db) {
	 	var collection = db.collection(collectionname);
	 	collection.findOne(data, function(err, document) {
	 		db.close();
	 		callback(document);
	 	});
	});
}

MongoDB.update = function(data,set,callback,collectionname){
	var url = 'mongodb://'+MongoDB.domain+':'+MongoDB.port+'/'+MongoDB.projectname;
	MongoClient.connect(url, function(err, db) {
	 	var collection = db.collection(collectionname);
	 	collection.update(data,{ $set: set}, function(err, result) {
	 		db.close();
	 		callback(result);
	 	});
	});
}

MongoDB.remove = function(data,callback,collectionname){
	var url = 'mongodb://'+MongoDB.domain+':'+MongoDB.port+'/'+MongoDB.projectname;
	MongoClient.connect(url, function(err, db) {
	 	var collection = db.collection(collectionname);
	 	collection.remove(data, function(err, result) {
	 		db.close();
	 		callback(result);
	 	});
	});
}

MongoDB.removeCollection = function(callback,collectionname){
	var url = 'mongodb://'+MongoDB.domain+':'+MongoDB.port+'/'+MongoDB.projectname;
	MongoClient.connect(url, function(err, db) {
	 	var collection = db.collection(collectionname);
	 	collection.remove({}, function(err, result) {
	 		db.close();
	 		callback(result);
	 	});
	});
}

module.exports = MongoDB;